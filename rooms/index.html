<!DOCTYPE html>
<html>
  <head>
		<title>Hello world</title>
		<link href="style.css" rel="stylesheet" type="text/css" />
	</head>
	<script src="/socket.io/socket.io.js"></script>
	<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script>

	var socket = io();
	var player = new Object;
	var rooms = new Array();
	
	function showRooms() {
		for (i=0;i<rooms.length;i++) {
			var memberNames = [];
			for (player of rooms[i].members) {
				memberNames += player.name;
				console.log(player);
			}
			var str = '<tr style="outline: thin solid"><td>Room ' + rooms[i].number + 
			'|</td><td>Host: ' + JSON.stringify(rooms[i].hostname) + 
			'|</td><td>Members: ' + memberNames + 
			'|</td><td><button onclick="joinRoom('+ rooms[i].number +');">Join Room</button></td></tr>';
			console.log(str);
			$("#rooms").append(str);
		}
	}
	
	socket.on('initClient', function(data){
		player.id = data.clientId;
		console.log('you are client ' + data.clientId);
	});

	socket.on('roomUpdate', function(data){
		$("#rooms").html('');
		rooms = [];
		for (i=0;i<data.rooms.length;i++) {
			rooms.push(data.rooms[i]);
		}
		showRooms();
	})
	
	function createPlayer() {
		player.name = document.getElementById('name').value;
	}

	function test() {
		socket.emit('clientTestEvent', 'We are sending an event from the client!');
	}

	function addRoom() {
		socket.emit('clientaddRoom', player);
		// when i add room, player only has id=clinetid and name=nameFromCreatePLayer
	}
	
	function joinRoom(roomid) {
		console.log(player,roomid);
		socket.emit('clientjoinRoom', {player,roomid} );
	}

  </script>
 <body>
	<div id="hello">Hello world</div>
	<input id="name" type="text" name="name" value="" placeholder="Enter your name!">
	<button onclick="createPlayer();">Create Player</button>
	<button onclick="test();" >Send Message</button>
	<button onclick="addRoom();">Add Room</button>
	<table id="rooms">Rooms</table>
</body>
</html>